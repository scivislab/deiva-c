#------------------------------------------------------------------------------#
# Copyright (c) 2014 Los Alamos National Security, LLC
# All rights reserved.
#------------------------------------------------------------------------------#

################################################################################
# Please Do Not Edit This File Unless You Know What You Are Doing!!!
#
# Project-specific configuration rules should be added in the 'config'
# subdirectory of the top-level of this project in the appropriate file,
# e.g., package configuration options should go in 'config/packages.cmake'.
#
# For more documentation on the design philosophy of this build system
# and the recognized configuration files that can be added to the 'config'
# subdirectory, please look in 'cinch/README.md' and 'cinch/INSTALL.md'
# from the top-level of this project.
#
# Any changes to the basic build template should be discussed with the
# project maintainers.
################################################################################

#------------------------------------------------------------------------------#
# Add public headers
#------------------------------------------------------------------------------#

if(EXISTS ${CMAKE_CURRENT_SOURCE_DIR}/library.cmake)
    include(${CMAKE_CURRENT_SOURCE_DIR}/library.cmake)
endif(EXISTS ${CMAKE_CURRENT_SOURCE_DIR}/library.cmake)

#------------------------------------------------------------------------------#
# Add subdirectories
#
# This uses a glob, i.e., all sub-directories will be added at this level.
# This is not true for levels below this one.  This allows some flexibility
# while keeping the generic case as simple as possible.
#------------------------------------------------------------------------------#

cinch_subdirlist(_SUBDIRECTORIES ${CMAKE_CURRENT_SOURCE_DIR} False)

#------------------------------------------------------------------------------#
# Add subdirectory files
#------------------------------------------------------------------------------#

# May need to move this up...
#if(ENABLE_COMMON_HEADER)
list(APPEND INCDIRS ${CMAKE_CURRENT_SOURCE_DIR})
#endif(ENABLE_COMMON_HEADER)

# This loop adds header and source files for each listed sub-directory
# to the main header and source file lists.  Additionally, it adds the
# listed sub-directories to the include search path.  Lastly, it creates
# a catalog for each sub-directory with information on the source and
# headers files from the directory using the 'info.cmake' script that is
# located in the top-level 'cmake' directory.

#foreach(_SUBDIR ${CINCH_CONFIG_SUBDIRECTORIES})

foreach(_SUBDIR ${_SUBDIRECTORIES})

    message(STATUS
        "Adding source subdirectory '${_SUBDIR}' to ${library_target_name}")

    unset(${_SUBDIR}_HEADERS)
    unset(${_SUBDIR}_SOURCES)

    add_subdirectory(${_SUBDIR})

    foreach(_HEADER ${${_SUBDIR}_HEADERS})
        list(APPEND HEADERS
            ${CMAKE_CURRENT_SOURCE_DIR}/${_SUBDIR}/${_HEADER})
    endforeach(_HEADER)

    foreach(_SOURCE ${${_SUBDIR}_SOURCES})
        list(APPEND SOURCES
            ${CMAKE_CURRENT_SOURCE_DIR}/${_SUBDIR}/${_SOURCE})
    endforeach(_SOURCE)

    cinch_make_info("${library_target_name}.${CINCH_CONFIG_INFOTAG}${_SUBDIR}"
        "${${_SUBDIR}_HEADERS}" "${${_SUBDIR}_SOURCES}")
endforeach(_SUBDIR)

set(${library_target_name}_HEADERS ${HEADERS} PARENT_SCOPE)
set(${library_target_name}_SOURCES ${SOURCES} PARENT_SCOPE)
set(${library_target_name}_INCDIRS ${INCDIRS} PARENT_SCOPE)

#------------------------------------------------------------------------------#
# Formatting options for emacs and vim.
# vim: set tabstop=4 shiftwidth=4 expandtab :
#-----------------------------------------------------------------------------#
